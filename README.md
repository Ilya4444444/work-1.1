Алгоритм Simulated Annealing (имитация отжига)

Вариант 12. Поиск с имитацией отжига для раскраски графа
Задача: реализовать имитацию отжига для задачи раскраски графа с минимизацией числа
цветов.

Требования:
- Входные данные: неориентированный граф
- Выход: раскраска вершин и количество использованных цветов
- Вывести текущее число конфликтов при понижении температуры

Входные данные:
Граф с 10 вершинами и 15 ребрами

Объяснение алгоритма:

1. Инициализация параметров - задаем начальную температуру, скорость охлаждения и минимальную температуру (initial_temp=1000, cooling_rate=0.95, min_temp=0.1).
2. Генерация начального решения - создаем случайную раскраску вершин k цветами (random.randint(1, k)).
3. Подсчет конфликтов - считаем количество ребер, соединяющих вершины одинакового цвета (if coloring[u] == coloring[v]: conflicts += 1).
4. Генерация соседнего решения - случайным образом меняем цвет одной вершины (vertex = random.choice(self.vertices)).
5. Вычисление разницы качества - сравниваем количество конфликтов текущего и нового решения (delta = neighbor_conflicts - current_conflicts).
6. Критерий принятия решения - принимаем новое решение если оно лучше или с вероятностью exp(-Δ/T) (if delta < 0 or random.random() < math.exp(-delta / temperature)).
7. Охлаждение системы - уменьшаем температуру на каждом шаге (temperature *= cooling_rate).
8. Проверка условия останова - завершаем при достижении минимальной температуры или допустимой раскраски (while temperature > min_temp).
9. Уменьшение числа цветов - повторяем процесс для меньшего количества цветов (for k in range(2, max_colors + 1)).

Временная сложность с объяснением:

O(n^3) - алгоритм выполняет три вложенных процесса: внешний цикл по температуре (O(n)), внутри которого проверяются все ребра графа (O(n^2)) для подсчета конфликтов, и так для каждой итерации охлаждения. На плотных графах количество ребер E ≈ n^2, что в сочетании с линейным количеством итераций дает общую сложность O(n × n^3) = O(n^3).

Контрольный вопрос:

12. Критерий Метрополиса
Какова формула критерия Метрополиса в алгоритме имитации отжига и что она означает?

Ответ: Формула критерия Метрополиса: P = exp(-ΔE/T), где ΔE - изменение энергии (разница качества решений), T - текущая температура. Эта формула определяет вероятность принятия ухудшающего решения: если новое решение хуже текущего (ΔE > 0), алгоритм может принять его с вероятностью P, что позволяет избегать локальных минимумов на ранних этапах при высоких температурах, а при охлаждении системы (уменьшении T) алгоритм становится более "жадным" и принимает только улучшающие решения.
